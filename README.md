# Portfolio (TanStack Start + Convex)

Minimalist portfolio, with a realtime Convex-powered admin panel.

## Features

- Public portfolio page at `/`
  - Hero widgets: availability, quick stats, Spotify now playing
  - Sign the Wall widget with moderated ticker
  - Projects loaded from Convex (`published` only)
  - Testimonials with interactive switching
  - Contact form writing to Convex inbox
  - Analytics tracking (page views, project interactions, CTA clicks, testimonial switch, contact submits, wall submits)
- Admin panel at `/admin`
  - Google login gate for owner-only access
  - CRUD + reorder for projects and testimonials
  - Messages inbox with status updates
  - Analytics dashboard (KPI, timeseries, top projects)
  - Wall moderation tab (pending/approved/archived)
  - Site widget settings editor
  - One-click dummy content seeding

## Stack

- TanStack Start (React)
- Convex (database + realtime functions)
- Better Auth (Google sign-in for admin access)
- Tailwind + shadcn/ui

## Notes

- `src/routeTree.gen.ts` is auto-generated by TanStack Router. Do not edit manually.
- Admin auth is enforced (no open mode).
- Required env vars for admin auth:
  - `GOOGLE_CLIENT_ID`
  - `GOOGLE_CLIENT_SECRET`
  - `BETTER_AUTH_URL` (for example `http://localhost:3000` or your production domain)
  - `OWNER_EMAILS` (comma-separated allowlist)
  - `ADMIN_ISSUE_SECRET` (shared secret used between app server and Convex)
- If your Convex deployment schema changed, run your Convex workflow (`npx convex dev`) to refresh generated types.
- Current environment warning seen during build: Vite requires newer Node (`20.19+` or `22.12+`).
- Spotify widget data is served from Convex (`spotifyNowPlaying.getPublic`) and refreshed via Convex action (`spotifyNowPlaying.refresh`).
- Spotify credentials must be set in Convex env (`npx convex env set ...`), not only in app `.env`.
- Spotify refresh token quick setup:
  1. Create an app in Spotify Developer Dashboard and copy client id/secret.
  2. Authorize with `scope=user-read-currently-playing user-read-recently-played`.
  3. Exchange code for refresh token and set `SPOTIFY_REFRESH_TOKEN` in env.
- Full setup walkthrough: see `docs/spotify-widget-setup.md`.
- Google admin auth walkthrough: see `docs/google-auth-admin-setup.md`.
- Fallback behavior: active playback shows `playing`, otherwise the latest recently played track shows `idle`; API failures return `unavailable` without breaking layout.
